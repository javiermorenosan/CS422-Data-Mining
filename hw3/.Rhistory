library(factoextra)
rm(list=ls())
setwd("/Users/JavierMoreno/Desktop/Chicago/courses/CS422 Data Mining/hw3")
mammals <- read.csv("file19-cleaned.txt", sep = ",", header = TRUE)
mammals.scaled <- scale(mammals)
mammals.scaled <- scale(mammals[-1])
fviz_nbclust(mammals[-1], kmeans, method = "wss")
fviz_nbclust(mammals.scaled, kmeans, method = "wss")
fviz_nbclust(mammals.scaled, kmeans, method = "silhouette")
fviz_nbclust(mammals.scaled, kmeans, method = "wss")
k <- kmeans(mammals[-1], centers=8)
fviz_cluster(k, mammals[-1])
#       1     2     3     4     5     6     7    8
x <- c(210,  195,  180,  200,  235,  110,   90, 126)  # Weight in lbs
y <- c(5.08, 4.03, 6.00, 5.02, 5.07, 5.03, 4.0, 5.01) # Height in feets and inches
# Remember from previous lecture: location of points in a 2-d space
# does not change even after scaling.  In a sense, scaling "adjusts"
# the coordinates.  So, with that ...
plot(x, y, main="Raw Data")
text(x,y, pos=2, labels=c("1", "2", "3", "4", "5", "6", "7", "8"))
df <- data.frame(weight=x, height=y)
df.scaled <- scale(df)
k <- kmeans(df, centers=2)
k.scaled <- kmeans(df.scaled, centers=2)
# Now let's see what the clusters looks like, scaled and unscaled.
fviz_cluster(k, data=df, main="Unscaled clusters")
fviz_cluster(k.scaled, data=df.scaled, main="Scaled clusters")
# Let's look at their distances, for scaled and unscaled versions.
# Notice the distance from point 5 to points 6, 7, 8.  5's 'x' attribute
# tends to dominate the 'x' attributes of 6,7,8.
dist(data.frame(x=x, y=y), method="euclidean", upper=T)
dist(scale(data.frame(x=x, y=y)), method="euclidean", upper=T)
# And finally, let's see what's contained in the results returned
# by kmeans()
print(k.scaled)
rm(list=ls())
setwd("/Users/JavierMoreno/Desktop/Chicago/courses/CS422 Data Mining/hw3")
mammals <- read.csv("file19-cleaned.txt", sep = ",", header = TRUE)
mammals.scaled <- scale(mammals[-1])
fviz_nbclust(mammals.scaled, kmeans, method = "wss")
k <- kmeans(mammals[-1], centers=8)
fviz_cluster(k, mammals[-1])
print(k)
print(k)
k
summary(k)
sum(k)
cluster1 <- mammals[1, cluster1Indices]
cluster1 <- mammals[1]
cluester1
cluster1
cluster1 <- namez[cluster1Indices]
cluster1 <- namezs(cluster1Indices)
cluster1 <- namezs[cluster1Indices]
cluster1 <- names[cluster1Indices]
cluster1 <- names(cluster1Indices)
cluster1Indices <- which(k$cluster == 1)
cluster1 <- names(cluster1Indices)
cluster1
cluster1 <- names[cluster1Indices]
names <- mammals[1, cluster1Indices]
names <- mammals[cluster1Indices, 1]
names
names <- mammals[cluster2Indices, 1]
cluster2Indices <- which(k$cluster == 2)
names2 <- mammals[cluster2Indices, 1]
names2
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 1]
cluster2 <- mammals[cluster2Indices, 1]
cluster3 <- mammals[cluster2Indices, 1]
cluster4 <- mammals[cluster2Indices, 1]
cluster5 <- mammals[cluster2Indices, 1]
cluster6 <- mammals[cluster2Indices, 1]
cluster7 <- mammals[cluster2Indices, 1]
cluster8 <- mammals[cluster2Indices, 1]
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 1]
cluster2 <- mammals[cluster2Indices, 1]
cluster3 <- mammals[cluster2Indices, 1]
cluster4 <- mammals[cluster2Indices, 1]
cluster5 <- mammals[cluster2Indices, 1]
cluster6 <- mammals[cluster2Indices, 1]
cluster7 <- mammals[cluster2Indices, 1]
cluster8 <- mammals[cluster2Indices, 1]
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 1]
cluster2 <- mammals[cluster2Indices, 1]
cluster3 <- mammals[cluster3Indices, 1]
cluster4 <- mammals[cluster4Indices, 1]
cluster5 <- mammals[cluster5Indices, 1]
cluster6 <- mammals[cluster6Indices, 1]
cluster7 <- mammals[cluster7Indices, 1]
cluster8 <- mammals[cluster8Indices, 1]
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
?read.csv()
mammals <- read.csv("file19-cleaned.txt", sep = ",", header = TRUE, row.names = 1)
mammals.scaled <- scale(mammals)
fviz_nbclust(mammals.scaled, kmeans, method = "wss")
fviz_nbclust(mammals.scaled, kmeans, method = "silhouette")
k <- kmeans(mammals, centers=8)
fviz_cluster(k, mammals)
print(k)
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 1]
cluster2 <- mammals[cluster2Indices, 1]
cluster3 <- mammals[cluster3Indices, 1]
cluster4 <- mammals[cluster4Indices, 1]
cluster5 <- mammals[cluster5Indices, 1]
cluster6 <- mammals[cluster6Indices, 1]
cluster7 <- mammals[cluster7Indices, 1]
cluster8 <- mammals[cluster8Indices, 1]
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
cluster1 <- mammals[cluster1Indices, 0]
cluster1
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 0]
cluster2 <- mammals[cluster2Indices, 0]
cluster3 <- mammals[cluster3Indices, 0]
cluster4 <- mammals[cluster4Indices, 0]
cluster5 <- mammals[cluster5Indices, 0]
cluster6 <- mammals[cluster6Indices, 0]
cluster7 <- mammals[cluster7Indices, 0]
cluster8 <- mammals[cluster8Indices, 0]
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
library(dplyr)
set.seed(1122)
?sample_n()
mammals.sampled <- sample_n(mammals, 35)
mammals.sampled
?eclust()
e <- eclast(mammals.sampled, FUNcluster = "hclust")
e <- eclust(mammals.sampled, FUNcluster = "hclust")
fviz_dend(e)
e
print(e)
summary(e)
str(e)
mammals.sampled <- sample_n(mammals, 35)
hclust <- eclust(mammals.sampled, FUNcluster = "hclust")
fviz_dend(hclust)
fviz_dend(hclust)
?eclust()
single <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "single")
complete <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "complete")
average <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "average")
fviz_dend(single)
fviz_dend(complete)
fviz_dend(average)
fviz_dend(single)
fviz_dend(single)
fviz_dend(complete)
fviz_dend(average)
k <- kmeans(mammals.scaled, centers=8)
fviz_cluster(k, mammals.scaled)
print(k)
cluster1Indices <- which(k$cluster == 1)
cluster2Indices <- which(k$cluster == 2)
cluster3Indices <- which(k$cluster == 3)
cluster4Indices <- which(k$cluster == 4)
cluster5Indices <- which(k$cluster == 5)
cluster6Indices <- which(k$cluster == 6)
cluster7Indices <- which(k$cluster == 7)
cluster8Indices <- which(k$cluster == 8)
cluster1 <- mammals[cluster1Indices, 0]
cluster2 <- mammals[cluster2Indices, 0]
cluster3 <- mammals[cluster3Indices, 0]
cluster4 <- mammals[cluster4Indices, 0]
cluster5 <- mammals[cluster5Indices, 0]
cluster6 <- mammals[cluster6Indices, 0]
cluster7 <- mammals[cluster7Indices, 0]
cluster8 <- mammals[cluster8Indices, 0]
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
cluster1
cluster2
cluster3
cluster4
cluster5
cluster6
cluster7
cluster8
cluster3
cluster3
cluster4
cluster5
cluster6
cluster7
cluster4
set.seed(1122)
mammals.sampled <- sample_n(mammals.scaled, 35)
mammals.sampled <- sample_n(mammals, 35)
single <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "single")
single <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "single")
complete <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "complete")
average <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "average")
fviz_dend(single)
fviz_dend(complete)
fviz_dend(average)
m <- as.data.frame(as.table(mammals.scaled))
mammals.sampled <- sample_n(m, 35)
single <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "single")
View(m)
m <- as.data.frame(mammals.scaled)
mammals.sampled <- sample_n(m, 35)
single <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "single")
complete <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "complete")
complete <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "complete")
average <- eclust(mammals.sampled, FUNcluster = "hclust", hc_method = "average")
fviz_dend(single)
fviz_dend(complete)
fviz_dend(average)
fviz_dend(single)
fviz_dend(single)
fviz_dend(complete)
fviz_dend(average)
data(iris)
# Scale the data
d <- scale(iris[,1:4])
hc.complete <- hclust(dist(d), method="complete")
plot(hc.complete)
# Cut at around Height = 5 to get 3 clusters, or
clusters.3 <- cutree(hc.complete, 3)
plot(clusters.3)
table(clusters.3)
table(iris$Species)
hc.single <- hclust(dist(d), method="single")
plot(hc.single)
?eclust()
?fviz_nbclust()
fviz_nbclust(mammals.sampled, FUNcluster = "hcut")
single2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 8, hc_method = "single")
complete2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 8, hc_method = "complete")
average2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 8, hc_method = "average")
fviz_dend(single2)
fviz_dend(complete2)
fviz_dend(average2)
single2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 3, hc_method = "single")
average2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 3, hc_method = "average")
fviz_dend(single2)
fviz_dend(single2)
fviz_dend(complete2)
fviz_dend(complete2)
fviz_dend(average2)
single2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 3, hc_method = "single")
fviz_dend(single2)
complete2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 3, hc_method = "complete")
fviz_dend(complete2)
average2 <- eclust(mammals.sampled, FUNcluster = "hclust", k = 3, hc_method = "average")
fviz_dend(average2)
?cluster.stats()
dist(single2)
single2.dist()
single2.distance()
single2.distances()
single2
